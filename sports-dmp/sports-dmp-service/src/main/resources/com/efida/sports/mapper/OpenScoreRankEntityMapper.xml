<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="com.efida.sports.dmp.dao.mapper.OpenScoreRankEntityMapper">
	<resultMap id="BaseResultMap"
		type="com.efida.sports.dmp.dao.entity.OpenScoreRankEntity">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		<id column="id" jdbcType="BIGINT" property="id" />
		<result column="unit_code" jdbcType="VARCHAR"
			property="unitCode" />
		<result column="batch_number" jdbcType="VARCHAR"
			property="batchNumber" />
		<result column="score_rank_code" jdbcType="VARCHAR"
			property="scoreRankCode" />
		<result column="player_code" jdbcType="VARCHAR"
			property="playerCode" />
		<result column="player_phone" jdbcType="VARCHAR"
			property="playerPhone" />
		<result column="player_name" jdbcType="VARCHAR"
			property="playerName" />
		<result column="part_code" jdbcType="VARCHAR"
			property="partCode" />
		<result column="part_time" jdbcType="TIMESTAMP"
			property="partTime" />
		<result column="game_code" jdbcType="VARCHAR"
			property="gameCode" />
		<result column="game_name" jdbcType="VARCHAR"
			property="gameName" />
		<result column="match_code" jdbcType="VARCHAR"
			property="matchCode" />
		<result column="match_name" jdbcType="VARCHAR"
			property="matchName" />
		<result column="field_code" jdbcType="VARCHAR"
			property="fieldCode" />
		<result column="field_name" jdbcType="VARCHAR"
			property="fieldName" />
		<result column="match_group_code" jdbcType="VARCHAR"
			property="matchGroupCode" />
		<result column="match_group_name" jdbcType="VARCHAR"
			property="matchGroupName" />
		<result column="event_code" jdbcType="VARCHAR"
			property="eventCode" />
		<result column="event_name" jdbcType="VARCHAR"
			property="eventName" />
		<result column="score_name" jdbcType="VARCHAR"
			property="scoreName" />
		<result column="score" jdbcType="DECIMAL" property="score" />
		<result column="score_unit" jdbcType="VARCHAR"
			property="scoreUnit" />
		<result column="score_desc" jdbcType="VARCHAR"
			property="scoreDesc" />
		<result column="ranking" jdbcType="INTEGER" property="ranking" />
		<result column="promotion" jdbcType="VARCHAR"
			property="promotion" />
		<result column="ext_prop" jdbcType="VARCHAR" property="extProp" />
		<result column="channel_code" jdbcType="VARCHAR"
			property="channelCode" />
		<result column="idempotent_id" jdbcType="VARCHAR"
			property="idempotentId" />
		<result column="source" jdbcType="TINYINT" property="source" />
		<result column="sync" jdbcType="TINYINT" property="sync" />
		<result column="sync_total" jdbcType="INTEGER"
			property="syncTotal" />
		<result column="sync_status" jdbcType="VARCHAR"
			property="syncStatus" />
		<result column="competition_code" jdbcType="VARCHAR"
			property="competitionCode" />
		<result column="next_sync_time" jdbcType="TIMESTAMP"
			property="nextSyncTime" />
		<result column="gmt_create" jdbcType="TIMESTAMP"
			property="gmtCreate" />
		<result column="gmt_modified" jdbcType="TIMESTAMP"
			property="gmtModified" />
	</resultMap>
	<sql id="Base_Column_List">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		id,batch_number, unit_code, score_rank_code, player_code,
		player_phone,
		player_name, part_code,
		part_time,
		game_code,game_name,match_code,
		match_name, field_code,
		field_name,
		match_group_code,
		match_group_name,
		event_code, event_name,
		score_name,
		score, score_unit, score_desc,
		ranking,
		promotion,
		ext_prop,
		channel_code, idempotent_id, source, sync,
		sync_total,
		sync_status,competition_code, next_sync_time, gmt_create,
		gmt_modified
	</sql>

	<select id="selectByPrimaryKey" parameterType="java.lang.Long"
		resultMap="BaseResultMap">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select
		<include refid="Base_Column_List" />
		from open_score_rank
		where id = #{id,jdbcType=BIGINT}
	</select>
	<delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		delete from open_score_rank
		where id = #{id,jdbcType=BIGINT}
	</delete>

	<delete id="deleteAutoRankByPrimaryKey" parameterType="java.lang.Long">
		delete from open_score_rank
		where id = #{id,jdbcType=BIGINT} and source = 3
	</delete>	
	
	
	<insert id="insert"
		parameterType="com.efida.sports.dmp.dao.entity.OpenScoreRankEntity">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		insert into open_score_rank (id,batch_number, unit_code,
		score_rank_code,
		player_code, player_phone, player_name,
		part_code,
		part_time,
		game_code,game_name,
		match_code,
		match_name, field_code,
		field_name,
		match_group_code,
		match_group_name, event_code,
		event_name,
		score_name,
		score,
		score_unit, score_desc, ranking,
		promotion, ext_prop,
		channel_code,
		idempotent_id, source, sync,
		sync_total, sync_status,
		competition_code, next_sync_time,
		gmt_create, gmt_modified
		)
		values
		(#{id,jdbcType=BIGINT},
		#{batchNumber,jdbcType=VARCHAR},
		#{unitCode,jdbcType=VARCHAR},
		#{scoreRankCode,jdbcType=VARCHAR},
		#{playerCode,jdbcType=VARCHAR},
		#{playerPhone,jdbcType=VARCHAR},
		#{playerName,jdbcType=VARCHAR},
		#{partCode,jdbcType=VARCHAR},
		#{partTime,jdbcType=TIMESTAMP},
		#{gameCode,jdbcType=VARCHAR},
		#{gameName,jdbcType=VARCHAR},
		#{matchCode,jdbcType=VARCHAR},
		#{matchName,jdbcType=VARCHAR},
		#{fieldCode,jdbcType=VARCHAR},
		#{fieldName,jdbcType=VARCHAR},
		#{matchGroupCode,jdbcType=VARCHAR},
		#{matchGroupName,jdbcType=VARCHAR}, #{eventCode,jdbcType=VARCHAR},
		#{eventName,jdbcType=VARCHAR}, #{scoreName,jdbcType=VARCHAR},
		#{score,jdbcType=DOUBLE},
		#{scoreUnit,jdbcType=VARCHAR},
		#{scoreDesc,jdbcType=VARCHAR}, #{ranking,jdbcType=INTEGER},
		#{promotion,jdbcType=VARCHAR}, #{extProp,jdbcType=VARCHAR},
		#{channelCode,jdbcType=VARCHAR},
		#{idempotentId,jdbcType=VARCHAR},
		#{source,jdbcType=TINYINT},#{sync,jdbcType=TINYINT},
		#{syncTotal,jdbcType=INTEGER},
		#{syncStatus,jdbcType=VARCHAR},
		#{competitionCode,jdbcType=VARCHAR},
		#{nextSyncTime,jdbcType=TIMESTAMP},
		now(), now()
		)
	</insert>
	<insert id="insertSelective"
		parameterType="com.efida.sports.dmp.dao.entity.OpenScoreRankEntity">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		insert into open_score_rank
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="id != null">
				id,
			</if>
			<if test="batchNumber != null">
				batch_number,
			</if>
			<if test="unitCode != null">
				unit_code,
			</if>
			<if test="scoreRankCode != null">
				score_rank_code,
			</if>
			<if test="playerCode != null">
				player_code,
			</if>
			<if test="playerPhone != null">
				player_phone,
			</if>
			<if test="playerName != null">
				player_name,
			</if>
			<if test="partCode != null">
				part_code,
			</if>
			<if test="partTime != null">
				part_time,
			</if>
			<if test="gameCode != null">
				game_code,
			</if>
			<if test="gameName != null">
				game_name,
			</if>
			<if test="matchCode != null">
				match_code,
			</if>
			<if test="matchName != null">
				match_name,
			</if>
			<if test="fieldCode != null">
				field_code,
			</if>
			<if test="fieldName != null">
				field_name,
			</if>
			<if test="matchGroupCode != null">
				match_group_code,
			</if>
			<if test="matchGroupName != null">
				match_group_name,
			</if>
			<if test="eventCode != null">
				event_code,
			</if>
			<if test="eventName != null">
				event_name,
			</if>
			<if test="scoreName != null">
				score_name,
			</if>
			<if test="score != null">
				score,
			</if>
			<if test="scoreUnit != null">
				score_unit,
			</if>
			<if test="scoreDesc != null">
				score_desc,
			</if>
			<if test="ranking != null">
				ranking,
			</if>
			<if test="promotion != null">
				promotion,
			</if>
			<if test="extProp != null">
				ext_prop,
			</if>
			<if test="channelCode != null">
				channel_code,
			</if>
			<if test="idempotentId != null">
				idempotent_id,
			</if>
			<if test="source != null">

				source,
			</if>
			<if test="sync != null">
				sync,
			</if>
			<if test="syncTotal != null">
				sync_total,
			</if>
			<if test="syncStatus != null">
				sync_status,
			</if>
			<if test="competitionCode != null">
				competition_code,
			</if>
			<if test="nextSyncTime != null">
				next_sync_time,
			</if>
			gmt_create,
			gmt_modified
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="id != null">
				#{id,jdbcType=BIGINT},
			</if>
			<if test="batchNumber != null">
				#{batchNumber,jdbcType=VARCHAR},
			</if>
			<if test="unitCode != null">
				#{unitCode,jdbcType=VARCHAR},
			</if>
			<if test="scoreRankCode != null">
				#{scoreRankCode,jdbcType=VARCHAR},
			</if>
			<if test="playerCode != null">
				#{playerCode,jdbcType=VARCHAR},
			</if>
			<if test="playerPhone != null">
				#{playerPhone,jdbcType=VARCHAR},
			</if>
			<if test="playerName != null">
				#{playerName,jdbcType=VARCHAR},
			</if>
			<if test="partCode != null">
				#{partCode,jdbcType=VARCHAR},
			</if>
			<if test="partTime != null">
				#{partTime,jdbcType=TIMESTAMP},
			</if>
			<if test="gameCode != null">
				#{gameCode,jdbcType=VARCHAR},
			</if>
			<if test="gameName != null">
				#{gameName,jdbcType=VARCHAR},
			</if>
			<if test="matchCode != null">
				#{matchCode,jdbcType=VARCHAR},
			</if>
			<if test="matchName != null">
				#{matchName,jdbcType=VARCHAR},
			</if>
			<if test="fieldCode != null">
				#{fieldCode,jdbcType=VARCHAR},
			</if>
			<if test="fieldName != null">
				#{fieldName,jdbcType=VARCHAR},
			</if>
			<if test="matchGroupCode != null">
				#{matchGroupCode,jdbcType=VARCHAR},
			</if>
			<if test="matchGroupName != null">
				#{matchGroupName,jdbcType=VARCHAR},
			</if>
			<if test="eventCode != null">
				#{eventCode,jdbcType=VARCHAR},
			</if>
			<if test="eventName != null">
				#{eventName,jdbcType=VARCHAR},
			</if>
			<if test="scoreName != null">
				#{scoreName,jdbcType=VARCHAR},
			</if>
			<if test="score != null">
				#{score,jdbcType=DOUBLE},
			</if>
			<if test="scoreUnit != null">
				#{scoreUnit,jdbcType=VARCHAR},
			</if>
			<if test="scoreDesc != null">
				#{scoreDesc,jdbcType=VARCHAR},
			</if>
			<if test="ranking != null">
				#{ranking,jdbcType=INTEGER},
			</if>
			<if test="promotion != null">
				#{promotion,jdbcType=VARCHAR},
			</if>
			<if test="extProp != null">
				#{extProp,jdbcType=VARCHAR},
			</if>
			<if test="channelCode != null">
				#{channelCode,jdbcType=VARCHAR},
			</if>
			<if test="idempotentId != null">
				#{idempotentId,jdbcType=VARCHAR},
			</if>

			<if test="source != null">
				#{source,jdbcType=TINYINT},
			</if>
			<if test="sync != null">
				#{sync,jdbcType=TINYINT},
			</if>
			<if test="syncTotal != null">
				#{syncTotal,jdbcType=INTEGER},
			</if>
			<if test="syncStatus != null">
				#{syncStatus,jdbcType=VARCHAR},
			</if>
			<if test="competitionCode != null">
				#{competitionCode,jdbcType=VARCHAR},
			</if>
			<if test="nextSyncTime != null">
				#{nextSyncTime,jdbcType=TIMESTAMP},
			</if>
			now(),
			now()
		</trim>
	</insert>
	<update id="updateByPrimaryKeySelective"
		parameterType="com.efida.sports.dmp.dao.entity.OpenScoreRankEntity">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		update open_score_rank
		<set>
			<if test="batchNumber != null">
				batch_number=#{batchNumber,jdbcType=VARCHAR},
			</if>
			<if test="unitCode != null">
				unit_code = #{unitCode,jdbcType=VARCHAR},
			</if>
			<if test="scoreRankCode != null">
				score_rank_code = #{scoreRankCode,jdbcType=VARCHAR},
			</if>
			<if test="playerCode != null">
				player_code = #{playerCode,jdbcType=VARCHAR},
			</if>
			<if test="playerPhone != null">
				player_phone = #{playerPhone,jdbcType=VARCHAR},
			</if>
			<if test="playerName != null">
				player_name = #{playerName,jdbcType=VARCHAR},
			</if>
			<if test="partCode != null">
				part_code = #{partCode,jdbcType=VARCHAR},
			</if>
			<if test="partTime != null">
				part_time = #{partTime,jdbcType=TIMESTAMP},
			</if>
			<if test="gameCode != null">
				game_code = #{gameCode,jdbcType=VARCHAR},
			</if>
			<if test="gameName != null">
				game_name = #{gameName,jdbcType=VARCHAR},
			</if>
			<if test="matchCode != null">
				match_code = #{matchCode,jdbcType=VARCHAR},
			</if>
			<if test="matchName != null">
				match_name = #{matchName,jdbcType=VARCHAR},
			</if>
			<if test="fieldCode != null">
				field_code = #{fieldCode,jdbcType=VARCHAR},
			</if>
			<if test="fieldName != null">
				field_name = #{fieldName,jdbcType=VARCHAR},
			</if>
			<if test="matchGroupCode != null">
				match_group_code = #{matchGroupCode,jdbcType=VARCHAR},
			</if>
			<if test="matchGroupName != null">
				match_group_name = #{matchGroupName,jdbcType=VARCHAR},
			</if>
			<if test="eventCode != null">
				event_code = #{eventCode,jdbcType=VARCHAR},
			</if>
			<if test="eventName != null">
				event_name = #{eventName,jdbcType=VARCHAR},
			</if>
			<if test="scoreName != null">
				score_name = #{scoreName,jdbcType=VARCHAR},
			</if>
			<if test="score != null">
				score = #{score,jdbcType=DOUBLE},
			</if>
			<if test="scoreUnit != null">
				score_unit = #{scoreUnit,jdbcType=VARCHAR},
			</if>
			<if test="scoreDesc != null">
				score_desc = #{scoreDesc,jdbcType=VARCHAR},
			</if>
			<if test="ranking != null">
				ranking = #{ranking,jdbcType=INTEGER},
			</if>
			<if test="promotion != null">
				promotion = #{promotion,jdbcType=VARCHAR},
			</if>
			<if test="extProp != null">
				ext_prop = #{extProp,jdbcType=VARCHAR},
			</if>
			<if test="channelCode != null">
				channel_code = #{channelCode,jdbcType=VARCHAR},
			</if>
			<if test="idempotentId != null">
				idempotent_id = #{idempotentId,jdbcType=VARCHAR},
			</if>

			<if test="source != null">
				source = #{source,jdbcType=TINYINT},
			</if>
			<if test="sync != null">
				sync = #{sync,jdbcType=TINYINT},
			</if>
			<if test="syncTotal != null">
				sync_total = #{syncTotal,jdbcType=INTEGER},
			</if>
			<if test="syncStatus != null">
				sync_status = #{syncStatus,jdbcType=VARCHAR},
			</if>
			<if test="competitionCode != null">
				competition_code = #{competitionCode,jdbcType=VARCHAR},
			</if>
			<if test="nextSyncTime != null">
				next_sync_time = #{nextSyncTime,jdbcType=TIMESTAMP},
			</if>
			gmt_modified = now()
		</set>
		where id = #{id,jdbcType=BIGINT}
	</update>
	<update id="updateByPrimaryKey"
		parameterType="com.efida.sports.dmp.dao.entity.OpenScoreRankEntity">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		update open_score_rank
		set unit_code = #{unitCode,jdbcType=VARCHAR},
		batch_number = #{batchNumber,jdbcType=VARCHAR},

		score_rank_code =
		#{scoreRankCode,jdbcType=VARCHAR},
		player_code =
		#{playerCode,jdbcType=VARCHAR},
		player_phone =
		#{playerPhone,jdbcType=VARCHAR},
		player_name =
		#{playerName,jdbcType=VARCHAR},
		part_code =
		#{partCode,jdbcType=VARCHAR},
		part_time =
		#{partTime,jdbcType=TIMESTAMP},
		game_code =
		#{gameCode,jdbcType=VARCHAR},
		game_name =
		#{gameName,jdbcType=VARCHAR},
		match_code =
		#{matchCode,jdbcType=VARCHAR},
		match_name =
		#{matchName,jdbcType=VARCHAR},
		field_code =
		#{fieldCode,jdbcType=VARCHAR},
		field_name =
		#{fieldName,jdbcType=VARCHAR},
		match_group_code =
		#{matchGroupCode,jdbcType=VARCHAR},
		match_group_name =
		#{matchGroupName,jdbcType=VARCHAR},
		event_code =
		#{eventCode,jdbcType=VARCHAR},
		event_name =
		#{eventName,jdbcType=VARCHAR},
		score_name =
		#{scoreName,jdbcType=VARCHAR},
		score = #{score,jdbcType=DOUBLE},
		score_unit = #{scoreUnit,jdbcType=VARCHAR},
		score_desc =
		#{scoreDesc,jdbcType=VARCHAR},
		ranking = #{ranking,jdbcType=INTEGER},
		promotion = #{promotion,jdbcType=VARCHAR},
		ext_prop =
		#{extProp,jdbcType=VARCHAR},
		channel_code =
		#{channelCode,jdbcType=VARCHAR},
		idempotent_id =
		#{idempotentId,jdbcType=VARCHAR},

		source = #{source,jdbcType=TINYINT},
		sync = #{sync,jdbcType=TINYINT},
		sync_total =
		#{syncTotal,jdbcType=INTEGER},
		sync_status =
		#{syncStatus,jdbcType=VARCHAR},
		competition_code =
		#{competitionCode,jdbcType=VARCHAR},
		next_sync_time =
		#{nextSyncTime,jdbcType=TIMESTAMP},
		gmt_modified = now()
		where id =
		#{id,jdbcType=BIGINT}
	</update>
	<select id="getScoreRankInfoByIdempotent"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from open_score_rank
		<where>
			unit_code = #{unitCode,jdbcType=VARCHAR}
			and idempotent_id =
			#{idempotentId,jdbcType=VARCHAR}
		</where>
	</select>

	<!--自定义查询 -->
	<!--* unitCode * matchCode * eventCode * playerCode * scoreName * start -->
	<select id="selectByProp" parameterType="map"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from open_score_rank
		<where>
			<if test="unitCode != null and unitCode !=''">
				and unit_code = #{unitCode,jdbcType=VARCHAR}
			</if>
			<if test="matchCode != null and matchCode != '' ">
				and match_code = #{matchCode,jdbcType=VARCHAR}
			</if>
			<if test="eventCode != null and eventCode !='' ">
				and event_code = #{eventCode,jdbcType=VARCHAR}
			</if>
			<if test="playerCode != null and playerCode !='' ">
				and player_code = #{playerCode,jdbcType=VARCHAR}
			</if>
			<if test="scoreName != null and scoreName !='' ">
				and score_name = #{scoreName,jdbcType=VARCHAR}
			</if>
			<if test="playerPhone != null and playerPhone != ''">
				and player_phone = #{playerPhone,jdbcType=VARCHAR}
			</if>
		</where>
		order by id asc
		limit #{start} , #{limit}
	</select>

	<select id="getScoreRankByIdempId" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from open_score_rank where
		idempotent_id =
		#{idempotentId,jdbcType=VARCHAR}
		limit 0,1
	</select>

	<select id="getScoreRankByRankCode" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from open_score_rank where
		score_rank_code =
		#{rankCode,jdbcType=VARCHAR}
	</select>

	<select id="selectScoreRankByLikeParams"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from open_score_rank
		<where>
			<if test="unitCode != null and unitCode !=''">
				and unit_code = #{unitCode,jdbcType=VARCHAR}
			</if>
			<if test="match != null and match != '' ">
				and ( match_code like
				CONCAT('%',#{match,jdbcType=VARCHAR},'%') or match_name like
				CONCAT('%',#{match,jdbcType=VARCHAR},'%'))
			</if>
			<if test="playerPhone != null and playerPhone !='' ">
				and player_phone = #{playerPhone,jdbcType=VARCHAR}
			</if>
			<if test="channelCode != null and channelCode !='' ">
				and channel_code = #{channelCode,jdbcType=VARCHAR}
			</if>
			<if test="playerName != null and playerName !='' ">
				and player_name = #{playerName,jdbcType=VARCHAR}
			</if>
			<if test="startTime != null and startTime !='' ">
				and (<![CDATA[ gmt_create > #{startTime,jdbcType=VARCHAR}]]>)
			</if>
			<if test="endTime != null and endTime !='' ">
				and (<![CDATA[ gmt_create < #{endTime,jdbcType=VARCHAR}]]>)
			</if>
			<if test="socreType != null and socreType !='' ">
			   <if test="socreType =='unit' ">
			    and (<![CDATA[ competition_code is null or competition_code='']]>)
			   </if>
			    <if test="socreType =='dmp' ">
			    and (<![CDATA[ competition_code !='' and competition_code is not null]]>)
			   </if>
			</if>
		</where>
		<if test="sortField != null and sortField !='' ">
			<if test="sortField =='score' ">
				order by score
			</if>
			<if test="sortField =='ranking' ">
				order by ranking
			</if>
			<if test="sortField =='partTime' ">
				order by part_time
			</if>
			<if test="sortField =='gmtCreate' ">
				order by gmt_create
			</if>
		</if>
	   <if test="sortOrder =='desc' ">
			desc
		</if>
		<if test="sortOrder =='asc' ">
			asc
		</if>
	</select>


	<select id="querySoreByMap" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from open_score_rank
		<where>
			<if test="matchCode != null and matchCode != '' ">
				and match_code=#{matchCode}
			</if>
			<if test="competitionCode != null and competitionCode !='' ">
				and competition_code = #{competitionCode,jdbcType=VARCHAR}
			</if>
	 		 <if test="rankType != null and rankType =='unit' ">
				and (source = 1 or source = 2 or source is null ) 
			</if> 	
			
			<if test="playerPhone != null and playerPhone !='' ">
				and player_phone = #{playerPhone,jdbcType=VARCHAR}
			</if>
			<if test="null != groups and groups.size > 0">
				and match_group_code in

				<foreach collection="groups" item="groupCode" open="("
					separator="," close=")">
					#{groupCode}
				</foreach>
			</if>
			<if test="null != events and events.size > 0">
				and event_code in

				<foreach collection="events" item="eventCode" open="("
					separator="," close=")">
					#{eventCode}
				</foreach>
			</if>
			<if test="null !=areas  and areas.size > 0">
				and field_code in

				<foreach collection="areas" item="fileCode" open="("
					separator="," close=")">
					#{fileCode}
				</foreach>
			</if>

		</where>
		order by ranking
	</select>

	<!-- 只查询 自定义排名  -->
	<select id="querySelfRankByMap" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from open_score_rank
		<where>
			competition_code = #{competitionCode,jdbcType=VARCHAR}
		    and source = 3 
		    <if test="matchCode != null and matchCode != '' ">
				and match_code=#{matchCode}
			</if>
			<if test="playerPhone != null and playerPhone !='' ">
				and player_phone = #{playerPhone,jdbcType=VARCHAR}
			</if>
		</where>
		order by id asc
		limit #{start} , #{limit} 
	</select>


	<select id="queryHasScoreMatch" resultType="String">
		select match_code from open_score_rank
		<where>
			<if test="gameCode != null and gameCode !=''">
				and game_code = #{gameCode,jdbcType=VARCHAR}
			</if>
			<if test="playerPhone != null and playerPhone !='' ">
				and player_phone = #{playerPhone,jdbcType=VARCHAR}
			</if>
		</where>
	</select>
	<!--查询未同步记录， sync=3不同步，为出错记录 。 同步记录到证书功能 -->

	<select id="selectUnSyncRecord" parameterType="map"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from open_score_rank
		<where>
			( sync is null or sync = 0) and (next_sync_time is null or
			next_sync_time &lt;= now())
		</where>

		order by id asc
		limit #{start} , #{limit}
	</select>

	<select id="getAllRankByMatchAndPhone" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from open_score_rank
		<where>
			<if test="playerPhone != null and playerPhone !='' ">
				and player_phone = #{playerPhone,jdbcType=VARCHAR}
			</if>
			<if test="matchCode != null and matchCode !='' ">
				and match_code = #{matchCode,jdbcType=VARCHAR}
			</if>
		</where>
	</select>


	<select id="queryCompetitionScoreRank" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from open_score_rank
		<where>
			<if test="matchCode != null and matchCode != '' ">
				and match_code=#{matchCode}
			</if>
			<if test="competitionCode != null and competitionCode !='' ">
				and competition_code = #{competitionCode,jdbcType=VARCHAR}
			</if>
	 		 <if test="rankType != null and rankType =='unit' ">
				and (source = 1 or source = 2 or source is null ) 
			</if> 			
			<if test="null != groups and groups.size > 0">
				and match_group_code in
				<foreach collection="groups" item="groupCode" open="("
					separator="," close=")">
					#{groupCode}
				</foreach>
			</if>
			<if test="null != events and events.size > 0">
				and event_code in
				<foreach collection="events" item="eventCode" open="("
					separator="," close=")">
					#{eventCode}
				</foreach>
			</if>
			<if test="null !=areas  and areas.size > 0">
				and field_code in
				<foreach collection="areas" item="fileCode" open="("
					separator="," close=")">
					#{fileCode}
				</foreach>
			</if>
		</where>
		order by ranking asc
	</select>

	<!-- 删除比赛 通过 比赛编号  -->
	<delete id="deleteByCompetitionCode" parameterType="java.lang.String">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		delete from open_score_rank
		where source = 3 and competition_code = #{competitionCode,jdbcType=VARCHAR}
	</delete>

	<select id="selectCompetitionInfoByScore"  parameterType="java.lang.String" resultMap="BaseResultMap">
		select
			<include refid="Base_Column_List" />
		from open_score_rank
		<where>
			<if test="competitionCode != null and competitionCode != '' ">
				and competition_code=#{competitionCode,jdbcType=VARCHAR}
			</if>
		</where>
		group by event_code
	</select>

</mapper>